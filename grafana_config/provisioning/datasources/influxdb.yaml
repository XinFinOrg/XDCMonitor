apiVersion: 1

# First delete any existing datasources
deleteDatasources:
  - name: InfluxDB
    orgId: 1
  - name: internal node InfluxDB
    orgId: 1

# Then add back the InfluxDB datasources with the correct configuration
datasources:
  - name: InfluxDB
    uid: influxdb
    type: influxdb
    access: proxy
    url: http://influxdb:8086
    isDefault: true
    version: 2
    jsonData:
      version: Flux
      organization: xdc
      defaultBucket: xdc_metrics
      tlsSkipVerify: true
    secureJsonData:
      token: _INFLUXDB_TOKEN__
  - name: internal node InfluxDB
    uid: influxdb2
    type: influxdb
    access: proxy
    url: ${INTERNAL_NODE_INFLUXDB_URL}
    isDefault: false
    version: 2
    jsonData:
      version: InfluxDB
      organization: xdc
      defaultBucket: xdc_internal
      tlsSkipVerify: true
    secureJsonData:
      token: ${INTERNAL_NODE_INFLUXDB_TOKEN}
