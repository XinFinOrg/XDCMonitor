apiVersion: 1

groups:
  - name: XDC
    folder: Rules
    interval: 60s
    rules:
      - uid: test-alert
        title: 'Test Alert'
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: prometheus
            model:
              expr: 'vector(1)'
              intervalMs: 1000
              maxDataPoints: 43200
              refId: A
        noDataState: OK
        execErrState: Error
        for: 10s
        annotations:
          description: 'This is a test alert'
        labels:
          severity: info

      - uid: rpc-down
        title: 'RPC Endpoint Down'
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: prometheus
            model:
              expr: 'xdc_rpc_status == 0'
              intervalMs: 1000
              maxDataPoints: 43200
              refId: A
        noDataState: NoData
        execErrState: Error
        for: 5m
        annotations:
          summary: 'RPC Endpoint Down'
          description: 'The RPC endpoint {{ $labels.endpoint }} has been down for more than 5 minutes'
        labels:
          severity: critical
          category: infrastructure

      - uid: high-block-time
        title: 'High Block Time'
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: prometheus
            model:
              expr: 'xdc_block_time > 3'
              intervalMs: 1000
              maxDataPoints: 43200
              refId: A
        noDataState: NoData
        execErrState: Error
        for: 2m
        annotations:
          summary: 'Block time is too high'
          description: 'The average block time is higher than 3 seconds for more than 2 minutes'
        labels:
          severity: warning
          category: blockchain
